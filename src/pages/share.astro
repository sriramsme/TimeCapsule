---
// share.astro
import Layout from "@/layouts/Layout.astro";
import ShareViewer from "@/components/ShareViewer";
import Footer from "@/components/Footer.astro";
import type { LayoutMode } from "@/types";

export const prerender = false; // Force server-side rendering for this page
// Extract URL parameters server-side or client-side
const url = Astro.url.href;
const searchParams = Astro.url.searchParams;

const layoutMode = (searchParams.get("layout") as LayoutMode) || "masonry";
const showMetadata = searchParams.get("showMetadata") === "true";

const name = searchParams.get("name") || "Someone";
const pic = searchParams.get("pic") || "/og-image.png";

const title = `${name}'s TimeCapsule`;
const description = `${name} shared their TimeCapsule`;
const ogImage = pic;
---

<Layout title={title} description={description} ogImage={ogImage}>
    <ShareViewer
        client:load
        layoutMode={layoutMode}
        showMetadata={showMetadata}
    />
    <Footer />
</Layout>
